<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="navigateBack()">
        <ion-icon slot="icon-only" name="arrow-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title *ngIf="calledFrom === 'add'">Add Sales Invoice</ion-title>
    <ion-title *ngIf="calledFrom === 'edit'">Update Sales Invoice</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="page-background">
  <ion-fab
    class="ion-margin-end"
    slot="fixed"
    vertical="top"
    color="light"
    horizontal="end"
  >
    <ion-fab-button
      *ngIf="calledFrom === 'add'"
      class="fab-position"
      [disabled]="salesCustomerDetialsForm.invalid"
      (click)="submitDraft()"
    >
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
    <ion-fab-button
      *ngIf="calledFrom === 'edit'"
      class="fab-position"
      [disabled]="salesCustomerDetialsForm.invalid"
      (click)="updateSalesInvoice()"
    >
      <ion-icon name="create"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <form [formGroup]="salesCustomerDetialsForm">
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-text color="tertiary"> Details </ion-text>
        </ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <ion-grid class="ion-no-padding">
          <ion-row class="align">
            <ion-col>
              <mat-form-field class="example-half-width">
                <input
                  matInput
                  placeholder="Naming Series"
                  readonly
                  value="SINV-####"
                />
              </mat-form-field>
            </ion-col>
            <ion-col>
              <mat-form-field class="example-half-width">
                <input
                  matInput
                  required
                  placeholder="Company"
                  readonly
                  formControlName="company"
                />
                <mat-error *ngIf="f.company.hasError('required')">
                  Company is <strong>required</strong>
                </mat-error>
              </mat-form-field>
            </ion-col>
         

            <ion-col>
              <mat-form-field class="example-half-width">
                <input
                  required
                  type="text"
                  placeholder="Select Customer"
                  matInput
                  formControlName="customer"
                  [matAutocomplete]="auto"
                  (focusout)="validateInput(f.customer, filteredCustomerList)"
                />
                <mat-autocomplete
                  autoActiveFirstOption
                  #auto="matAutocomplete"
                  [displayWith]="getOptionText"
                  (optionSelected)="customerChanged($event.option.value)"
                >
           
                  <mat-option
                    *ngFor="let option of filteredCustomerList | async "
                    [value]="option"
                  >
                    {{ option.customer_name }}
                    <small class="text-muted"> {{option.customer_name}} </small>
                  </mat-option>
             
               
                </mat-autocomplete>
                <mat-error *ngIf="f.customer.hasError('falseValse')">
                  You should select a value from dropdown only.
                  <strong>'{{f.customer.value}}'</strong> is not allowed.
                </mat-error>
                <mat-error *ngIf="f.customer.hasError('required')">
                  Customer is <strong>required</strong>
                </mat-error>
              </mat-form-field>
            </ion-col>


            <ion-col>
              <mat-form-field class="example-half-width">
                <input
                  required
                  matInput
                  [matDatepicker]="postingDate"
                  placeholder="Posting Date"
                  readonly
                  formControlName="postingDate"
                  (dateChange)="selectedPostingDate($event)"
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="postingDate"
                ></mat-datepicker-toggle>
                <mat-datepicker #postingDate disabled="false"></mat-datepicker>
                <mat-error *ngIf="f.postingDate.hasError('required')">
                  Posting Date is <strong>required</strong>
                </mat-error>
              </mat-form-field>
            </ion-col>
        
            <ion-col>
              <mat-form-field class="example-half-width">
                <input
                  required
                  type="text"
                  placeholder="Select Warehouse"
                  matInput
                  formControlName="warehouse"
                  (focusout)="validateInput(f.warehouse, filteredWarehouseList)"
                  [matAutocomplete]="warehouse"
                />
                <mat-autocomplete
                  autoActiveFirstOption
                  #warehouse="matAutocomplete"
                  (optionSelected)="updateStockBalance($event.option.value)"
                >
                  <mat-option
                    *ngFor="let warehouse of filteredWarehouseList | async"
                    [value]="warehouse"
                  >
                    {{ warehouse }}
                  </mat-option>
                </mat-autocomplete>
                <mat-error *ngIf="f.warehouse.hasError('required')">
                  Warehouse is <strong>required</strong>
                </mat-error>
                <mat-error *ngIf="f.warehouse.hasError('falseValse')">
                  You should select a value from dropdown only.
                  <strong>'{{f.warehouse.value}}'</strong> is not allowed.
                </mat-error>
              </mat-form-field>
            </ion-col>



            <ion-col >
              <mat-form-field class="example-half-width">
                <input
                  required
                  matInput
                  [matDatepicker]="dueDate"
                  placeholder="Due Date"
                  readonly
                  formControlName="dueDate"
                  (dateChange)="selectedDueDate($event)"
                />
                <mat-datepicker-toggle
                  matSuffix
                  [for]="dueDate"
                ></mat-datepicker-toggle>
                <mat-datepicker #dueDate disabled="false"></mat-datepicker>
                <mat-error
                  *ngIf="f.dueDate.errors && f.dueDate.hasError('required')"
                >
                  Due Date is <strong>required</strong>
                </mat-error>
                <mat-error
                  *ngIf="f.dueDate.errors && f.dueDate.hasError('dueDate')"
                >
                  Due Date cannot be before posting date
                </mat-error>
              </mat-form-field>
            </ion-col>
         
       
            <ion-col>
              <mat-form-field class="example-half-width">
                <input
                  matInput
                  placeholder="Remaining Balance"
                  readonly
                  formControlName="balance"
                  [value]="salesCustomerDetialsForm.get('balance').value | curFormat | async"
                />
                <mat-error
                  *ngIf="f.balance.errors && f.balance.hasError('min')"
                >
                  Credit limit exceeded
                </mat-error>
              </mat-form-field>
            </ion-col>
         
            <ion-col size-md="6">
              <mat-form-field class="example-half-width">
                <mat-label>Remarks</mat-label>
                <textarea matInput formControlName="remarks"></textarea>
              </mat-form-field>
            </ion-col>
            <ion-col >
              <mat-form-field class="example-half-width">
                <input
                  required
                  type="text"
                  placeholder="Select territory"
                  matInput
                  formControlName="territory"
                  (focusout)="validateInput(f.territory, territoryList)"
                  [matAutocomplete]="territory"
                />
                <mat-autocomplete
                  autoActiveFirstOption
                  #territory="matAutocomplete"
                >
                  <mat-option
                    *ngFor="let territory of territoryList | async"
                    [value]="territory"
                  >
                    {{ territory }}
                  </mat-option>
                </mat-autocomplete>
                <mat-error *ngIf="f.territory.hasError('falseValse')">
                  You should select a value from dropdown only.
                  <strong>'{{f.territory.value}}'</strong> is not allowed.
                </mat-error>
              </mat-form-field>
            </ion-col>
            <ion-col>
              <mat-form-field class="mat-input-wrapper" appearance="none">
                <mat-checkbox matInput formControlName="campaign">
                  Campaign Invoice
                </mat-checkbox>
                <input matInput disabled />
              </mat-form-field>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>
    </ion-card>
    <!-- <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-text color="tertiary"> Address </ion-text>
        </ion-card-title>
      </ion-card-header>
      <ion-card-content
        *ngIf="address.name && salesCustomerDetialsForm.get('customer').value"
      >
        <ion-grid class="ion-no-padding">
          <ion-row>
            <ion-col>
              <ion-text class="example-full-width">
                {{address.name}}
                <br />
                {{address.address_line1}}
                <br />
                {{address.address_line2 ? address.address_line2 : ''}}
                <br />
                {{address.city}}-{{address.pincode}}
              </ion-text>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>
      <ion-card-content
        *ngIf="!address.name && salesCustomerDetialsForm.get('customer').value "
      >
        <ion-text class="example-full-width">
          No address assigned to customer
        </ion-text>
      </ion-card-content>
    </ion-card> -->
  </form>

  <ion-grid>
    <ion-row >
      <ion-col size="9">
        <form [formGroup]="salesInvoiceItemsForm">
          <ion-grid>
            <ion-row>
              <ion-col>
                <mat-form-field class="example-full-width">
                  <mat-label>Filter from</mat-label>
                  <mat-select formControlName="filterKey">
                    <mat-option *ngFor="let option of filterOptions" [value]="option"
                      >{{option}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </ion-col>
              <ion-col>
                <mat-form-field class="example-full-width">
                  <input
                    matInput
                    placeholder="Value"
                    formControlName="filterValue"
                    (keyup.enter)="setFilter()"
                  />
                </mat-form-field>
              </ion-col>
            </ion-row>
          </ion-grid>
      
          <div
            class="grid-container ion-padding custom-skeleton"
            *ngIf="isSkeletonTextVisible"
          >
            <ion-grid>
              <ion-row>
                <ion-col size="3" *ngFor="let items of [0,1,2,3]">
                  <ion-card class="grid-card">
                    <ion-card-header>
                      <ion-card-subtitle>
                        <ion-skeleton-text
                          animated
                          style="width: 70%"
                        ></ion-skeleton-text>
                      </ion-card-subtitle>
                    </ion-card-header>
                    <ion-card-content>
                      <ion-skeleton-text
                        animated
                        style="width: 70%"
                      ></ion-skeleton-text>
                    </ion-card-content>
                  </ion-card>
                </ion-col>
                <ion-col> </ion-col>
                <ion-col> </ion-col>
                <ion-col> </ion-col>
              </ion-row>
            </ion-grid>
          </div>
      
          <div class="grid-container" *ngIf="!isSkeletonTextVisible">
            <ion-grid>
              <ion-row>
                <ion-col size="3" *ngFor="let item of gridItems">
                  <ion-card
                    class="grid-card"
                    (click)="addFromItemsGrid(item)"
                    matTooltip="{{item.serial_no}}"
                    matTooltipPosition="above"
                  >
                    <ion-card-header>
                      <ion-card-subtitle> {{item.item_name}} </ion-card-subtitle>
                      <ion-card-subtitle color="primary"
                        >{{item.serial_no?item.serial_no:''}}</ion-card-subtitle
                      >
                    </ion-card-header>
                    <ion-card-content>
                      <ion-row color="primary">
                        <ion-col size="6">
                          {{item.rate}}
                        </ion-col>
                        <ion-col class="ion-text-right" size="6">
                          {{item.safety_stock}} {{item.stock_uom}}
                        </ion-col>
                        <ion-img class="item-image" src="data:image/jpeg;base64,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"></ion-img>
                      </ion-row>
                      <ion-button
                        fill="clear"
                        size="small"
                        color="primary"
                        *ngIf="item.rate">
                      </ion-button>
                    </ion-card-content>
                  </ion-card>
                </ion-col>
              </ion-row>
              <ion-row>
                <ion-col>
                  <ion-progress-bar
                    type="indeterminate"
                    color="primary"
                    *ngIf="isDataLoading"
                  ></ion-progress-bar>
      
                  <center>
                    <ion-button
                      fill="outline"
                      *ngIf="isLoadMoreVisible"
                      color="primary"
                      (click)="loadMoreData()"
                    >
                      Load More</ion-button
                    >
                  </center>
                </ion-col>
              </ion-row>
            </ion-grid>
          </div>
      
          <ion-card>
            <ion-card-header>
              <ion-row class="align">
                <ion-col>
                  <ion-card-title>
                    <ion-text color="tertiary"> Items </ion-text>
                  </ion-card-title>
                </ion-col>
                <ion-col class="ion-text-right" size="auto">
                  <ion-button
                    color="tertiary"
                    fill="outline"
                    matTooltip=" ( ctrl + i ) "
                    matTooltipPosition="above"
                    matTooltipClass="tooltip"
                    (ctrlI)="addItem()"
                    (click)="addItem()"
                  >
                    Add
                  </ion-button>
                </ion-col>
              </ion-row>
            </ion-card-header>
            <ion-card-content class="ion-no-padding">
              <ion-item lines="none">
                <mat-table #table [dataSource]="dataSource" style="width: 100%">
                  <ng-container matColumnDef="item">
                    <mat-header-cell *matHeaderCellDef>Item</mat-header-cell>
                    <mat-cell
                      *matCellDef="let row;let i = index"
                      [satPopoverAnchor]="p"
                      tabindex="0"
                      (keyup.enter)="p.open()"
                      (click)="p.open()"
                    >
                      <ng-container *ngIf="row.item_name">
                        {{row.item_name}}
                      </ng-container>
                      <span class="add-comment" *ngIf="!row.item_name">
                        Add an item
                      </span>
                      <sat-popover
                        #p
                        hasBackdrop
                        xAlign="start"
                        yAlign="start"
                        (closed)="updateItem(row,i,$event)"
                      >
                        <inline-edit
                          style="width: 400px !important"
                          [value]="row.item_name"
                          column="item"
                          [minimumPrice]="row.minimumPrice"
                        ></inline-edit>
                      </sat-popover>
                    </mat-cell>
                    <mat-footer-cell *matFooterCellDef> </mat-footer-cell>
                  </ng-container>
                  <ng-container matColumnDef="stock">
                    <mat-header-cell *matHeaderCellDef
                      >Available Stock</mat-header-cell
                    >
                    <mat-cell
                      *matCellDef="let row"
                      [ngStyle]="{'color': row.stock > 0 ? 'green' : 'red'}"
                    >
                      {{ row.stock }}
                    </mat-cell>
                    <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                  </ng-container>
                  <ng-container matColumnDef="quantity">
                    <mat-header-cell *matHeaderCellDef>Quantity</mat-header-cell>
                    <mat-cell
                      *matCellDef="let row"
                      [satPopoverAnchor]="p"
                      tabindex="0"
                      (keyup.enter)="p.open()"
                      (click)="p.open()"
                    >
                      <ng-container> {{row.qty}} </ng-container>
      
                      <sat-popover
                        #p
                        hasBackdrop
                        xAlign="start"
                        yAlign="start"
                        (closed)="updateQuantity(row, $event)"
                      >
                        <inline-edit
                          [value]="row.qty"
                          column="quantity"
                          [minimumPrice]="row.minimumPrice"
                        ></inline-edit>
                      </sat-popover>
                    </mat-cell>
                    <mat-footer-cell *matFooterCellDef> </mat-footer-cell>
                  </ng-container>
                  <ng-container matColumnDef="serial_no">
                    <mat-header-cell *matHeaderCellDef>Serial No</mat-header-cell>
                    <mat-cell
                      *matCellDef="let row;let i = index"
                      [satPopoverAnchor]="popover"
                      tabindex="0"
                      (keyup.enter)="popover.open()"
                      (click)="popover.open()"
                    >
                      <ng-container *ngIf="row.serial_no">
                        {{row.serial_no}}
                      </ng-container>
                      <span class="add-comment" *ngIf="!row.serial_no">
                        Add Serial No
                      </span>
                      <sat-popover
                        #popover
                        hasBackdrop
                        xAlign="start"
                        yAlign="start"
                        (closed)="updateSerial(row,$event)"
                      >
                        <inline-edit
                          style="width: 400px !important"
                          [value]="row.serial_no"
                          column="serial_no"
                          [minimumPrice]="row.minimumPrice"
                        ></inline-edit>
                      </sat-popover>
                    </mat-cell>
                    <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                  </ng-container>
                  <ng-container matColumnDef="rate">
                    <mat-header-cell *matHeaderCellDef>Rate</mat-header-cell>
                    <mat-cell
                      *matCellDef="let row"
                      [satPopoverAnchor]="p"
                      tabindex="0"
                      (keyup.enter)="p.open()"
                      (click)="p.open()"
                    >
                      <ng-container> {{row.rate}} </ng-container>
                      <sat-popover
                        #p
                        hasBackdrop
                        xAlign="start"
                        yAlign="start"
                        (closed)="updateRate(row, $event)"
                      >
                        <inline-edit
                          [value]="row.rate"
                          column="rate"
                          [minimumPrice]="row.minimumPrice"
                        ></inline-edit>
                      </sat-popover>
                    </mat-cell>
                    <mat-footer-cell *matFooterCellDef>Total </mat-footer-cell>
                  </ng-container>
                  <ng-container matColumnDef="total">
                    <mat-header-cell *matHeaderCellDef>Total</mat-header-cell>
                    <mat-cell *matCellDef="let row"
                      >{{row.rate * row.qty | curFormat | async}}</mat-cell
                    >
                    <mat-footer-cell *matFooterCellDef
                      >{{salesInvoiceItemsFormControls.total.value | curFormat | async
                      }}</mat-footer-cell
                    >
                  </ng-container>
                  <ng-container matColumnDef="delete">
                    <mat-header-cell *matHeaderCellDef></mat-header-cell>
                    <mat-cell *matCellDef="let row ; let i = index">
                      <ion-button
                        (click)="deleteRow(i)"
                        fill="clear"
                        class="ion-no-padding"
                        color="danger"
                      >
                        <ion-icon slot="icon-only" name="trash"></ion-icon>
                      </ion-button>
                    </mat-cell>
                    <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                  </ng-container>
                  <mat-header-row
                    *matHeaderRowDef="displayedColumns; sticky: true"
                  ></mat-header-row>
                  <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
                  <mat-footer-row
                    class="footer"
                    *matFooterRowDef="displayedColumns; sticky: true"
                  ></mat-footer-row>
                </mat-table>
              </ion-item>
            </ion-card-content>
          </ion-card>
        </form>
      </ion-col >

      <ion-col size="3">
        <ion-card>
          <ion-card-header>
            <ion-row class="align">
              <ion-col>
                <ion-card-title>
                  <ion-text color="tertiary"> Draft List </ion-text>
                </ion-card-title>
              </ion-col>
            </ion-row>
          </ion-card-header>
          <ion-card-content>
            <mat-table  [dataSource]="dataSource2">
              <ng-container [matColumnDef]="column" *ngFor="let column of displayedColumnsItems" >
                <th mat-header-cell class="draft-table" *matHeaderCellDef>{{column}}</th>
                <td mat-cell class="draft-table" *matCellDef="let row"> <a href="#">{{row[column]}}</a>  </td>
              </ng-container>        
              
              <mat-header-row *matHeaderRowDef="displayedColumnsItems; sticky: true"></mat-header-row>
              
              <mat-row *matRowDef="let row; columns: displayedColumnsItems"></mat-row>
              
          </mat-table>


        </ion-card-content>

        </ion-card>

        <form [formGroup]="paymentForm">
          <ion-card>
            <ion-card-header>
              <ion-row class="align">
                <ion-col>
                  <ion-card-title>
                    <ion-text color="tertiary"> Payment Method </ion-text>
                  </ion-card-title>
                </ion-col>
              </ion-row>
            </ion-card-header>
            <ion-card-content>
              <ion-grid class="ion-no-padding">
                <ion-row class="align">
                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="POS Profile"
                        matInput
                        formControlName="posProfile"
                        (focusout)="validateInput(paymentFormControls.posProfile, filteredPosProfileList)"
                        [matAutocomplete]="profile"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #profile="matAutocomplete"
                        [displayWith]="displayPosProfileName"
                      >
                        <mat-option
                          *ngFor="let profile of filteredPosProfileList | async"
                          [value]="profile"
                        >
                          {{ profile.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>
                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="Mode of Payment"
                        matInput
                        formControlName="modeOfPayment"
                        (focusout)="validateInput(paymentFormControls.modeOfPayment, filteredModeOfPaymentList)"
                        [matAutocomplete]="payment"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #payment="matAutocomplete"
                      >
                        <mat-option
                          *ngFor="let payment of filteredModeOfPaymentList | async"
                          [value]="payment.name"
                        >
                          {{ payment.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.modeOfPayment.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.modeOfPayment.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>
                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="VAT"
                        matInput
                        formControlName="vat"
                        [matAutocomplete]="profile"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #profile="matAutocomplete"
                        [displayWith]="displayPosProfileName"
                      >
                        <mat-option
                          *ngFor="let profile of filteredPosProfileList | async"
                          [value]="profile"
                        >
                          {{ profile.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>

                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="Discount"
                        matInput
                        formControlName="discount"
                        [matAutocomplete]="profile"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #profile="matAutocomplete"
                        [displayWith]="displayPosProfileName"
                      >
                        <mat-option
                          *ngFor="let profile of filteredPosProfileList | async"
                          [value]="profile"
                        >
                          {{ profile.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>

                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="Grand Total"
                        matInput
                        formControlName="grandTotal"
                        [matAutocomplete]="profile"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #profile="matAutocomplete"
                        [displayWith]="displayPosProfileName"
                      >
                        <mat-option
                          *ngFor="let profile of filteredPosProfileList | async"
                          [value]="profile"
                        >
                          {{ profile.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>

                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="Received Amount"
                        matInput
                        formControlName="receivedAmount"
                        [matAutocomplete]="profile"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #profile="matAutocomplete"
                        [displayWith]="displayPosProfileName"
                      >
                        <mat-option
                          *ngFor="let profile of filteredPosProfileList | async"
                          [value]="profile"
                        >
                          {{ profile.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>

                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="Change"
                        matInput
                        formControlName="change"
                        [matAutocomplete]="profile"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #profile="matAutocomplete"
                        [displayWith]="displayPosProfileName"
                      >
                        <mat-option
                          *ngFor="let profile of filteredPosProfileList | async"
                          [value]="profile"
                        >
                          {{ profile.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>

                  <ion-col>
                    <mat-form-field class="example-full-width">
                      <input
                        required
                        type="text"
                        placeholder="Due"
                        matInput
                        formControlName="due"
                        [matAutocomplete]="profile"
                      />
                      <mat-autocomplete
                        autoActiveFirstOption
                        #profile="matAutocomplete"
                        [displayWith]="displayPosProfileName"
                      >
                        <mat-option
                          *ngFor="let profile of filteredPosProfileList | async"
                          [value]="profile"
                        >
                          {{ profile.name }}
                        </mat-option>
                      </mat-autocomplete>
                      <mat-error
                        *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                      >
                        You should select a value from dropdown only.
                        <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                        is not allowed.
                      </mat-error>
                    </mat-form-field>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
          </form>
      </ion-col>
      <ion-col size="9">
          <div>
            <div style='float: right;'>
              <button mat-stroked-button (click)="makeDraft()" color="primary">Make Draft</button>
              &nbsp;&nbsp;
              <button mat-stroked-button (click)="submitPayment()" color="primary">Pay and Submit</button>
            </div>
          </div>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- <form [formGroup]="salesInvoiceItemsForm">
    <ion-grid>
      <ion-row>
        <ion-col>
          <mat-form-field class="example-half-width">
            <mat-label>Filter from</mat-label>
            <mat-select formControlName="filterKey">
              <mat-option *ngFor="let option of filterOptions" [value]="option"
                >{{option}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </ion-col>
        <ion-col>
          <mat-form-field class="example-full-width">
            <input
              matInput
              placeholder="Search Item"
              formControlName="filterValue"
              (keyup.enter)="setFilter()"
            />
          </mat-form-field>
        </ion-col>
      </ion-row>
    </ion-grid>

    <div
      class="grid-container ion-padding custom-skeleton"
      *ngIf="isSkeletonTextVisible"
    >
      <ion-grid>
        <ion-row>
          <ion-col size="3" *ngFor="let items of [0,1,2,3]">
            <ion-card class="grid-card">
              <ion-card-header>
                <ion-card-subtitle>
                  <ion-skeleton-text
                    animated
                    style="width: 70%"
                  ></ion-skeleton-text>
                </ion-card-subtitle>
              </ion-card-header>
              <ion-card-content>
                <ion-skeleton-text
                  animated
                  style="width: 70%"
                ></ion-skeleton-text>
              </ion-card-content>
            </ion-card>
          </ion-col>
          <ion-col> </ion-col>
          <ion-col> </ion-col>
          <ion-col> </ion-col>
        </ion-row>
      </ion-grid>
    </div>

    <div class="grid-container" *ngIf="!isSkeletonTextVisible">
      <ion-grid>
        <ion-row>
          <ion-col size="3" *ngFor="let item of gridItems">
            <ion-card
              class="grid-card"
              (click)="addFromItemsGrid(item)"
              matTooltip="{{item.serial_no}}"
              matTooltipPosition="above"
            >
              <ion-card-header>
                <ion-card-subtitle> {{item.item_name}} </ion-card-subtitle>
                <ion-card-subtitle color="primary"
                  >{{item.serial_no?item.serial_no:''}}</ion-card-subtitle
                >
              </ion-card-header>
              <ion-card-content>
                <ion-row color="primary">
                  <ion-col size="6">
                    {{item.rate}}
                  </ion-col>
                  <ion-col class="ion-text-right" size="6">
                    {{item.safety_stock}} {{item.stock_uom}}
                  </ion-col>
                  <ion-img class="item-image" src="data:image/jpeg;base64,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"></ion-img>
                </ion-row>
                <ion-button
                  fill="clear"
                  size="small"
                  color="primary"
                  *ngIf="item.rate">
                </ion-button>
              </ion-card-content>
            </ion-card>
          </ion-col>
        </ion-row>
        <ion-row>
          <ion-col>
            <ion-progress-bar
              type="indeterminate"
              color="primary"
              *ngIf="isDataLoading"
            ></ion-progress-bar>

            <center>
              <ion-button
                fill="outline"
                *ngIf="isLoadMoreVisible"
                color="primary"
                (click)="loadMoreData()"
              >
                Load More</ion-button
              >
            </center>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>

    <ion-card>
      <ion-card-header>
        <ion-row class="align">
          <ion-col>
            <ion-card-title>
              <ion-text color="tertiary"> Items </ion-text>
            </ion-card-title>
          </ion-col>
          <ion-col class="ion-text-right" size="auto">
            <ion-button
              color="tertiary"
              fill="outline"
              matTooltip=" ( ctrl + i ) "
              matTooltipPosition="above"
              matTooltipClass="tooltip"
              (ctrlI)="addItem()"
              (click)="addItem()"
            >
              Add
            </ion-button>
          </ion-col>
        </ion-row>
      </ion-card-header>
      <ion-card-content class="ion-no-padding">
        <ion-item lines="none">
          <mat-table #table [dataSource]="dataSource" style="width: 100%">
            <ng-container matColumnDef="item">
              <mat-header-cell *matHeaderCellDef>Item</mat-header-cell>
              <mat-cell
                *matCellDef="let row;let i = index"
                [satPopoverAnchor]="p"
                tabindex="0"
                (keyup.enter)="p.open()"
                (click)="p.open()"
              >
                <ng-container *ngIf="row.item_name">
                  {{row.item_name}}
                </ng-container>
                <span class="add-comment" *ngIf="!row.item_name">
                  Add an item
                </span>
                <sat-popover
                  #p
                  hasBackdrop
                  xAlign="start"
                  yAlign="start"
                  (closed)="updateItem(row,i,$event)"
                >
                  <inline-edit
                    style="width: 400px !important"
                    [value]="row.item_name"
                    column="item"
                    [minimumPrice]="row.minimumPrice"
                  ></inline-edit>
                </sat-popover>
              </mat-cell>
              <mat-footer-cell *matFooterCellDef> </mat-footer-cell>
            </ng-container>
            <ng-container matColumnDef="stock">
              <mat-header-cell *matHeaderCellDef
                >Available Stock</mat-header-cell
              >
              <mat-cell
                *matCellDef="let row"
                [ngStyle]="{'color': row.stock > 0 ? 'green' : 'red'}"
              >
                {{ row.stock }}
              </mat-cell>
              <mat-footer-cell *matFooterCellDef></mat-footer-cell>
            </ng-container>
            <ng-container matColumnDef="quantity">
              <mat-header-cell *matHeaderCellDef>Quantity</mat-header-cell>
              <mat-cell
                *matCellDef="let row"
                [satPopoverAnchor]="p"
                tabindex="0"
                (keyup.enter)="p.open()"
                (click)="p.open()"
              >
                <ng-container> {{row.qty}} </ng-container>

                <sat-popover
                  #p
                  hasBackdrop
                  xAlign="start"
                  yAlign="start"
                  (closed)="updateQuantity(row, $event)"
                >
                  <inline-edit
                    [value]="row.qty"
                    column="quantity"
                    [minimumPrice]="row.minimumPrice"
                  ></inline-edit>
                </sat-popover>
              </mat-cell>
              <mat-footer-cell *matFooterCellDef> </mat-footer-cell>
            </ng-container>
            <ng-container matColumnDef="serial_no">
              <mat-header-cell *matHeaderCellDef>Serial No</mat-header-cell>
              <mat-cell
                *matCellDef="let row;let i = index"
                [satPopoverAnchor]="popover"
                tabindex="0"
                (keyup.enter)="popover.open()"
                (click)="popover.open()"
              >
                <ng-container *ngIf="row.serial_no">
                  {{row.serial_no}}
                </ng-container>
                <span class="add-comment" *ngIf="!row.serial_no">
                  Add Serial No
                </span>
                <sat-popover
                  #popover
                  hasBackdrop
                  xAlign="start"
                  yAlign="start"
                  (closed)="updateSerial(row,$event)"
                >
                  <inline-edit
                    style="width: 400px !important"
                    [value]="row.serial_no"
                    column="serial_no"
                    [minimumPrice]="row.minimumPrice"
                  ></inline-edit>
                </sat-popover>
              </mat-cell>
              <mat-footer-cell *matFooterCellDef></mat-footer-cell>
            </ng-container>
            <ng-container matColumnDef="rate">
              <mat-header-cell *matHeaderCellDef>Rate</mat-header-cell>
              <mat-cell
                *matCellDef="let row"
                [satPopoverAnchor]="p"
                tabindex="0"
                (keyup.enter)="p.open()"
                (click)="p.open()"
              >
                <ng-container> {{row.rate}} </ng-container>
                <sat-popover
                  #p
                  hasBackdrop
                  xAlign="start"
                  yAlign="start"
                  (closed)="updateRate(row, $event)"
                >
                  <inline-edit
                    [value]="row.rate"
                    column="rate"
                    [minimumPrice]="row.minimumPrice"
                  ></inline-edit>
                </sat-popover>
              </mat-cell>
              <mat-footer-cell *matFooterCellDef>Total </mat-footer-cell>
            </ng-container>
            <ng-container matColumnDef="total">
              <mat-header-cell *matHeaderCellDef>Total</mat-header-cell>
              <mat-cell *matCellDef="let row"
                >{{row.rate * row.qty | curFormat | async}}</mat-cell
              >
              <mat-footer-cell *matFooterCellDef
                >{{salesInvoiceItemsFormControls.total.value | curFormat | async
                }}</mat-footer-cell
              >
            </ng-container>
            <ng-container matColumnDef="delete">
              <mat-header-cell *matHeaderCellDef></mat-header-cell>
              <mat-cell *matCellDef="let row ; let i = index">
                <ion-button
                  (click)="deleteRow(i)"
                  fill="clear"
                  class="ion-no-padding"
                  color="danger"
                >
                  <ion-icon slot="icon-only" name="trash"></ion-icon>
                </ion-button>
              </mat-cell>
              <mat-footer-cell *matFooterCellDef></mat-footer-cell>
            </ng-container>
            <mat-header-row
              *matHeaderRowDef="displayedColumns; sticky: true"
            ></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
            <mat-footer-row
              class="footer"
              *matFooterRowDef="displayedColumns; sticky: true"
            ></mat-footer-row>
          </mat-table>
        </ion-item>
      </ion-card-content>
    </ion-card>
  </form> -->

  <!-- <form [formGroup]="paymentForm">
    <ion-card>
      <ion-card-header>
        <ion-row class="align">
          <ion-col>
            <ion-card-title>
              <ion-text color="tertiary"> Payment Method </ion-text>
            </ion-card-title>
          </ion-col>
        </ion-row>
      </ion-card-header>
      <ion-card-content>
        <ion-grid class="ion-no-padding">
          <ion-row class="align">
            <ion-col>
              <mat-form-field class="example-full-width">
                <input
                  required
                  type="text"
                  placeholder="POS Profile"
                  matInput
                  formControlName="posProfile"
                  (focusout)="validateInput(paymentFormControls.posProfile, filteredPosProfileList)"
                  [matAutocomplete]="profile"
                />
                <mat-autocomplete
                  autoActiveFirstOption
                  #profile="matAutocomplete"
                  [displayWith]="displayPosProfileName"
                >
                  <mat-option
                    *ngFor="let profile of filteredPosProfileList | async"
                    [value]="profile"
                  >
                    {{ profile.name }}
                  </mat-option>
                </mat-autocomplete>
                <mat-error
                  *ngIf="paymentFormControls.posProfile.hasError('falseValse')"
                >
                  You should select a value from dropdown only.
                  <strong>'{{paymentFormControls.posProfile.value}}'</strong>
                  is not allowed.
                </mat-error>
              </mat-form-field>
            </ion-col>
            <ion-col>
              <mat-form-field class="example-full-width">
                <input
                  required
                  type="text"
                  placeholder="Mode of Payment"
                  matInput
                  formControlName="modeOfPayment"
                  (focusout)="validateInput(paymentFormControls.modeOfPayment, filteredModeOfPaymentList)"
                  [matAutocomplete]="payment"
                />
                <mat-autocomplete
                  autoActiveFirstOption
                  #payment="matAutocomplete"
                >
                  <mat-option
                    *ngFor="let payment of filteredModeOfPaymentList | async"
                    [value]="payment.name"
                  >
                    {{ payment.name }}
                  </mat-option>
                </mat-autocomplete>
                <mat-error
                  *ngIf="paymentFormControls.modeOfPayment.hasError('falseValse')"
                >
                  You should select a value from dropdown only.
                  <strong>'{{paymentFormControls.modeOfPayment.value}}'</strong>
                  is not allowed.
                </mat-error>
              </mat-form-field>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-card-content>
    </ion-card>
  </form> -->
</ion-content>
